<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio</title>
    <script>
        // function openAppOrRedirect(appSchema, appStoreUrl, fallbackUrl) {
        //     if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {
        //         // iOS 기기인 경우 팝업 표시
        //         // alert("아이폰에서 호출되었습니다.");

        //         // 앱 스키마 호출
        //         var startTime = Date.now();
        //         var iframe = document.createElement("iframe");
        //         iframe.style.display = "none";
        //         iframe.src = appSchema;
        //         document.body.appendChild(iframe);

        //         setTimeout(function () {
        //             document.body.removeChild(iframe);
        //             if (Date.now() - startTime < 2000) {
        //                 window.location.replace(appStoreUrl || fallbackUrl);
        //             }
        //         }, 1500);
        //     } else {
        //         // iOS 기기가 아닌 경우 앱 스토어 URL로 리디렉션
        //         window.location.replace(appStoreUrl);
        //     }
        // }

		//호출가능
        // function openAppOrRedirect(appSchema, appStoreUrl, fallbackUrl) {
        //     if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {
        //         // iOS 기기에서 동작
        //         alert("아이폰에서 호출되었습니다.");
                
        //         var startTime = Date.now();
        //         window.location.href = appSchema;
                
        //         setTimeout(function () {
        //             var elapsedTime = Date.now() - startTime;
        //             if (elapsedTime < 2000) {
        //                 window.location.replace(appStoreUrl || fallbackUrl);
        //             }
        //         }, 1500);
        //     } else {
        //         // iOS가 아닌 경우 앱 스토어로 이동
        //         window.location.replace(appStoreUrl);
        //     }
        // }


        function openAppOrRedirect(appSchema, appStoreUrl) {
            if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {
                alert("아이폰에서 호출되었습니다.");
                
                var startTime = Date.now();
                var hidden = false;
                
                function handleVisibilityChange() {
                    hidden = document.hidden;
                }
                
                document.addEventListener("visibilitychange", handleVisibilityChange);
                
                window.location.href = appSchema;
                
                setTimeout(function () {
                    document.removeEventListener("visibilitychange", handleVisibilityChange);
                    var elapsedTime = Date.now() - startTime;
                    
                    if (!hidden && elapsedTime < 2000) {
                        window.location.replace(appStoreUrl);
                    }
                }, 1500);
            } else {
                window.location.replace(appStoreUrl);
            }
        }


        function goToAppStore(appStoreUrl) {
            window.location.replace(appStoreUrl);
        }

        // window.onload = function() {
        //     setTimeout(function() {
        //         openAppOrRedirect('kakaotalk://', 'https://apps.apple.com/kr/app/kakaotalk/id362057947', 'https://yourwebsite.com/fallback');
        //     }, 1000); // 페이지 로드 후 1초 뒤 실행
        // };
    </script>
</head>
<body>
    <p>Hello, World!14</p>
    <button onclick="openAppOrRedirect('kakaotalk://', 'https://apps.apple.com/kr/app/kakaotalk/id362057947', 'https://yourwebsite.com/fallback')">카카오톡 열기/설치</button>
    <button onclick="goToAppStore('https://apps.apple.com/kr/app/kakaotalk/id362057947')">스토어로 이동</button>
</body>
</html>
